<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>‡∏£‡πâ‡∏≤‡∏ô‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏î‡∏µ‡∏•‡∏¥‡πÄ‡∏ä‡∏µ‡∏¢‡∏™ - ‡∏™‡∏±‡πà‡∏á‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏≠‡∏≠‡∏ô‡πÑ‡∏•‡∏ô‡πå</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Kanit:wght@300;400;500;600;700&display=swap');
        body { font-family: 'Kanit', sans-serif; }
        
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1000;
            padding: 12px 20px;
            border-radius: 8px;
            color: white;
            font-weight: bold;
            animation: slideInRight 0.3s ease-out;
        }
        
        @keyframes slideInRight {
            from { transform: translateX(100%); }
            to { transform: translateX(0); }
        }
        
        .notification.success { background: linear-gradient(135deg, #10b981, #059669); }
        .notification.error { background: linear-gradient(135deg, #ef4444, #dc2626); }
        .notification.info { background: linear-gradient(135deg, #3b82f6, #1d4ed8); }
        
        .menu-card {
            transition: all 0.3s ease;
        }
        
        .menu-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 12px 30px rgba(0,0,0,0.15);
        }
        
        .cart-item {
            animation: slideInUp 0.3s ease-out;
        }
        
        @keyframes slideInUp {
            from { transform: translateY(20px); opacity: 0; }
            to { transform: translateY(0); opacity: 1; }
        }
        
        .status-badge {
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.875rem;
            font-weight: bold;
        }
        
        .status-pending { background: #fef3c7; color: #92400e; }
        .status-preparing { background: #dbeafe; color: #1e40af; }
        .status-ready { background: #d1fae5; color: #065f46; }
        .status-delivered { background: #f3f4f6; color: #374151; }
        .status-cancelled { background: #fee2e2; color: #991b1b; }
        
        .pulse-animation {
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }
        
        .cart-floating {
            position: fixed;
            bottom: 20px;
            right: 20px;
            z-index: 1000;
        }
        
        .order-tracking {
            position: relative;
        }
        
        .tracking-line {
            position: absolute;
            left: 15px;
            top: 40px;
            bottom: 0;
            width: 2px;
            background: #e5e7eb;
        }
        
        .tracking-step {
            position: relative;
            z-index: 1;
        }
        
        .tracking-step.completed .tracking-line {
            background: #10b981;
        }
        
        .modal {
            backdrop-filter: blur(4px);
        }
        
        .slip-preview {
            max-width: 300px;
            max-height: 400px;
            object-fit: contain;
        }
    </style>
</head>
<body class="bg-gray-50">
    <!-- Header -->
    <header class="bg-white shadow-lg sticky top-0 z-50">
        <div class="container mx-auto px-4 py-4">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-4">
                    <div class="text-4xl">üè™</div>
                    <div>
                        <h1 class="text-2xl font-bold text-gray-800">‡∏£‡πâ‡∏≤‡∏ô‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏î‡∏µ‡∏•‡∏¥‡πÄ‡∏ä‡∏µ‡∏¢‡∏™</h1>
                        <p class="text-gray-600">‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏≠‡∏£‡πà‡∏≠‡∏¢ ‡∏™‡πà‡∏á‡∏ñ‡∏∂‡∏á‡∏ö‡πâ‡∏≤‡∏ô</p>
                    </div>
                </div>
                <div class="flex items-center space-x-4">
                    <div class="text-right">
                        <div class="text-sm text-gray-600">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏£‡πâ‡∏≤‡∏ô</div>
                        <div class="font-bold text-green-600 flex items-center">
                            <div class="w-3 h-3 bg-green-500 rounded-full mr-2 pulse-animation"></div>
                            ‡πÄ‡∏õ‡∏¥‡∏î‡πÉ‡∏´‡πâ‡∏ö‡∏£‡∏¥‡∏Å‡∏≤‡∏£
                        </div>
                    </div>
                    <button onclick="showOrderHistory()" class="bg-blue-500 text-white px-4 py-2 rounded-lg hover:bg-blue-600 transition-all">
                        üìã ‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏™‡∏±‡πà‡∏á
                    </button>
                </div>
            </div>
        </div>
    </header>

    <!-- Navigation -->
    <nav class="bg-orange-500 text-white">
        <div class="container mx-auto px-4">
            <div class="flex space-x-1">
                <button onclick="showTab('menu')" class="tab-button active px-6 py-3 font-medium hover:bg-orange-600 transition-all">
                    üçΩÔ∏è ‡πÄ‡∏°‡∏ô‡∏π‡∏≠‡∏≤‡∏´‡∏≤‡∏£
                </button>
                <button onclick="showTab('cart')" class="tab-button px-6 py-3 font-medium hover:bg-orange-600 transition-all">
                    üõí ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå (<span id="cartCount">0</span>)
                </button>
                <button onclick="showTab('tracking')" class="tab-button px-6 py-3 font-medium hover:bg-orange-600 transition-all">
                    üì¶ ‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå
                </button>
            </div>
        </div>
    </nav>

    <!-- Main Content -->
    <main class="container mx-auto px-4 py-6">
        <!-- Menu Tab -->
        <div id="menuTab" class="tab-content">
            <!-- Customer Info -->
            <div class="bg-white rounded-xl shadow-lg p-6 mb-6">
                <h2 class="text-xl font-bold mb-4 text-gray-800">üìù ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡∏™‡∏±‡πà‡∏á‡∏≠‡∏≤‡∏´‡∏≤‡∏£</h2>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div>
                        <label class="block text-sm font-medium mb-2">‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏• *</label>
                        <input type="text" id="customerName" class="w-full p-3 border rounded-lg focus:ring-2 focus:ring-orange-500" placeholder="‡∏Å‡∏£‡∏≠‡∏Å‡∏ä‡∏∑‡πà‡∏≠-‡∏ô‡∏≤‡∏°‡∏™‡∏Å‡∏∏‡∏•" required>
                    </div>
                    <div>
                        <label class="block text-sm font-medium mb-2">‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå *</label>
                        <input type="tel" id="customerPhone" class="w-full p-3 border rounded-lg focus:ring-2 focus:ring-orange-500" placeholder="08X-XXX-XXXX" required>
                    </div>
                    <div class="md:col-span-2">
                        <label class="block text-sm font-medium mb-2">‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà‡∏à‡∏±‡∏î‡∏™‡πà‡∏á *</label>
                        <textarea id="customerAddress" class="w-full p-3 border rounded-lg h-20 focus:ring-2 focus:ring-orange-500" placeholder="‡∏Å‡∏£‡∏≠‡∏Å‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏à‡∏±‡∏î‡∏™‡πà‡∏á" required></textarea>
                    </div>
                </div>
            </div>

            <!-- Menu Categories -->
            <div class="flex space-x-4 mb-6 overflow-x-auto">
                <button onclick="filterMenu('all')" class="category-filter active bg-orange-500 text-white px-6 py-2 rounded-full hover:bg-orange-600 whitespace-nowrap">
                    ‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
                </button>
                <button onclick="filterMenu('‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏à‡∏≤‡∏ô‡∏´‡∏•‡∏±‡∏Å')" class="category-filter bg-gray-200 text-gray-700 px-6 py-2 rounded-full hover:bg-gray-300 whitespace-nowrap">
                    ‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏à‡∏≤‡∏ô‡∏´‡∏•‡∏±‡∏Å
                </button>
                <button onclick="filterMenu('‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏î‡∏∑‡πà‡∏°')" class="category-filter bg-gray-200 text-gray-700 px-6 py-2 rounded-full hover:bg-gray-300 whitespace-nowrap">
                    ‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏î‡∏∑‡πà‡∏°
                </button>
                <button onclick="filterMenu('‡∏Ç‡∏≠‡∏á‡∏´‡∏ß‡∏≤‡∏ô')" class="category-filter bg-gray-200 text-gray-700 px-6 py-2 rounded-full hover:bg-gray-300 whitespace-nowrap">
                    ‡∏Ç‡∏≠‡∏á‡∏´‡∏ß‡∏≤‡∏ô
                </button>
                <button onclick="filterMenu('‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏ß‡πà‡∏≤‡∏á')" class="category-filter bg-gray-200 text-gray-700 px-6 py-2 rounded-full hover:bg-gray-300 whitespace-nowrap">
                    ‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏ß‡πà‡∏≤‡∏á
                </button>
            </div>

            <!-- Menu Grid -->
            <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6" id="menuGrid">
                <!-- Menus will be rendered here -->
            </div>
        </div>

        <!-- Cart Tab -->
        <div id="cartTab" class="tab-content hidden">
            <div class="bg-white rounded-xl shadow-lg p-6">
                <h2 class="text-2xl font-bold mb-6 text-gray-800">üõí ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå</h2>
                
                <div id="cartItems" class="space-y-4 mb-6">
                    <!-- Cart items will be rendered here -->
                </div>
                
                <div id="cartSummary" class="border-t pt-6">
                    <!-- Cart summary will be rendered here -->
                </div>
            </div>
        </div>

        <!-- Order Tracking Tab -->
        <div id="trackingTab" class="tab-content hidden">
            <div class="bg-white rounded-xl shadow-lg p-6">
                <h2 class="text-2xl font-bold mb-6 text-gray-800">üì¶ ‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå</h2>
                
                <div id="activeOrders" class="space-y-6">
                    <!-- Active orders will be rendered here -->
                </div>
            </div>
        </div>
    </main>

    <!-- Floating Cart Button -->
    <div class="cart-floating">
        <button onclick="showTab('cart')" class="bg-orange-500 text-white p-4 rounded-full shadow-lg hover:bg-orange-600 transition-all" id="floatingCartBtn">
            üõí <span id="floatingCartCount" class="bg-red-500 text-white rounded-full px-2 py-1 text-sm ml-1">0</span>
        </button>
    </div>

    <!-- Payment Modal -->
    <div id="paymentModal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 modal">
        <div class="bg-white rounded-xl p-8 w-full max-w-md mx-4 max-h-[90vh] overflow-y-auto">
            <h3 class="text-2xl font-bold mb-6 text-gray-800">üí≥ ‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô</h3>
            
            <div class="space-y-6">
                <!-- Order Summary -->
                <div class="bg-gray-50 p-4 rounded-lg">
                    <h4 class="font-bold mb-3">‡∏™‡∏£‡∏∏‡∏õ‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå</h4>
                    <div id="paymentOrderSummary">
                        <!-- Order summary will be rendered here -->
                    </div>
                </div>

                <!-- Payment Method -->
                <div>
                    <h4 class="font-bold mb-3">‡∏ß‡∏¥‡∏ò‡∏µ‡∏Å‡∏≤‡∏£‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô</h4>
                    <div class="space-y-3">
                        <label class="flex items-center p-3 border rounded-lg cursor-pointer hover:bg-gray-50">
                            <input type="radio" name="paymentMethod" value="transfer" class="mr-3" checked>
                            <div class="flex items-center">
                                <span class="text-2xl mr-3">üè¶</span>
                                <div>
                                    <div class="font-medium">‡πÇ‡∏≠‡∏ô‡πÄ‡∏á‡∏¥‡∏ô‡∏ú‡πà‡∏≤‡∏ô‡∏ò‡∏ô‡∏≤‡∏Ñ‡∏≤‡∏£</div>
                                    <div class="text-sm text-gray-600">‡πÇ‡∏≠‡∏ô‡πÄ‡∏á‡∏¥‡∏ô‡πÅ‡∏•‡∏∞‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡∏™‡∏•‡∏¥‡∏õ</div>
                                </div>
                            </div>
                        </label>
                        <label class="flex items-center p-3 border rounded-lg cursor-pointer hover:bg-gray-50">
                            <input type="radio" name="paymentMethod" value="cod" class="mr-3">
                            <div class="flex items-center">
                                <span class="text-2xl mr-3">üíµ</span>
                                <div>
                                    <div class="font-medium">‡πÄ‡∏Å‡πá‡∏ö‡πÄ‡∏á‡∏¥‡∏ô‡∏õ‡∏•‡∏≤‡∏¢‡∏ó‡∏≤‡∏á</div>
                                    <div class="text-sm text-gray-600">‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏≠‡∏≤‡∏´‡∏≤‡∏£</div>
                                </div>
                            </div>
                        </label>
                    </div>
                </div>

                <!-- Bank Transfer Details -->
                <div id="bankTransferDetails" class="bg-blue-50 p-4 rounded-lg border border-blue-200">
                    <h4 class="font-bold mb-3 text-blue-800">‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡πÇ‡∏≠‡∏ô‡πÄ‡∏á‡∏¥‡∏ô</h4>
                    <div id="bankInfo" class="space-y-2 text-sm">
                        <!-- Bank info will be loaded here -->
                    </div>
                    
                    <!-- QR Code -->
                    <div id="qrCodeSection" class="text-center mt-4">
                        <!-- QR Code will be displayed here -->
                    </div>
                </div>

                <!-- Slip Upload -->
                <div id="slipUploadSection">
                    <h4 class="font-bold mb-3">‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡∏™‡∏•‡∏¥‡∏õ‡∏Å‡∏≤‡∏£‡πÇ‡∏≠‡∏ô‡πÄ‡∏á‡∏¥‡∏ô</h4>
                    <div class="border-2 border-dashed border-gray-300 rounded-lg p-6 text-center hover:border-orange-400 transition-colors">
                        <input type="file" id="slipUpload" accept="image/*" class="hidden" onchange="handleSlipUpload(event)">
                        <div id="slipPreview" class="mb-4">
                            <div class="w-32 h-32 mx-auto bg-gray-100 rounded-lg flex items-center justify-center text-4xl" id="slipPreviewContainer">
                                üìÑ
                            </div>
                        </div>
                        <button type="button" onclick="document.getElementById('slipUpload').click()" class="bg-blue-500 text-white px-4 py-2 rounded-lg hover:bg-blue-600 transition-all">
                            üì∑ ‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡∏™‡∏•‡∏¥‡∏õ
                        </button>
                        <p class="text-xs text-gray-500 mt-2">‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö JPG, PNG (‡∏™‡∏π‡∏á‡∏™‡∏∏‡∏î 5MB)</p>
                    </div>
                </div>

                <!-- Action Buttons -->
                <div class="flex space-x-4 pt-4">
                    <button onclick="closePaymentModal()" class="flex-1 bg-gray-500 text-white py-3 rounded-lg hover:bg-gray-600 transition-all">
                        ‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å
                    </button>
                    <button onclick="confirmOrder()" class="flex-1 bg-green-500 text-white py-3 rounded-lg hover:bg-green-600 transition-all">
                        ‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡∏±‡πà‡∏á
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- Order History Modal -->
    <div id="orderHistoryModal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 modal">
        <div class="bg-white rounded-xl p-8 w-full max-w-4xl mx-4 max-h-[90vh] overflow-y-auto">
            <div class="flex justify-between items-center mb-6">
                <h3 class="text-2xl font-bold text-gray-800">üìã ‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏™‡∏±‡πà‡∏á‡∏≠‡∏≤‡∏´‡∏≤‡∏£</h3>
                <button onclick="closeOrderHistoryModal()" class="text-gray-500 hover:text-gray-700 text-2xl">‚úï</button>
            </div>
            
            <div id="orderHistoryContent" class="space-y-4">
                <!-- Order history will be rendered here -->
            </div>
        </div>
    </div>

    <script>
        // Customer Order System JavaScript
        let currentTab = 'menu';
        let menus = [];
        let cart = [];
        let currentMenuFilter = 'all';
        let customerOrders = [];
        let uploadedSlip = null;

        // Real-time Data Sync with POS System
        class CustomerDataManager {
            constructor() {
                this.isConnected = true;
                this.init();
            }

            init() {
                this.loadMenusFromPOS();
                this.loadCustomerData();
                this.startRealTimeSync();
            }

            loadMenusFromPOS() {
                // Load menus from POS system (localStorage simulation)
                const posData = localStorage.getItem('posSystemData');
                if (posData) {
                    const data = JSON.parse(posData);
                    menus = data.menus.filter(menu => menu.available);
                } else {
                    // Fallback sample menus
                    menus = [
                        { id: 1, name: '‡∏Ç‡πâ‡∏≤‡∏ß‡∏ú‡∏±‡∏î‡∏Å‡∏∏‡πâ‡∏á', category: '‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏à‡∏≤‡∏ô‡∏´‡∏•‡∏±‡∏Å', price: 120, image: 'üç§', description: '‡∏Ç‡πâ‡∏≤‡∏ß‡∏ú‡∏±‡∏î‡∏Å‡∏∏‡πâ‡∏á‡∏™‡∏î‡πÉ‡∏´‡∏°‡πà ‡∏£‡∏™‡∏ä‡∏≤‡∏ï‡∏¥‡πÄ‡∏Ç‡πâ‡∏°‡∏Ç‡πâ‡∏ô', prepTime: 15, available: true },
                        { id: 2, name: '‡∏ï‡πâ‡∏°‡∏¢‡∏≥‡∏Å‡∏∏‡πâ‡∏á', category: '‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏à‡∏≤‡∏ô‡∏´‡∏•‡∏±‡∏Å', price: 150, image: 'üç≤', description: '‡∏ï‡πâ‡∏°‡∏¢‡∏≥‡∏Å‡∏∏‡πâ‡∏á‡∏£‡∏™‡∏à‡∏±‡∏î‡∏à‡πâ‡∏≤‡∏ô ‡πÄ‡∏ú‡πá‡∏î‡∏£‡πâ‡∏≠‡∏ô', prepTime: 20, available: true },
                        { id: 3, name: '‡∏ä‡∏≤‡πÑ‡∏ó‡∏¢', category: '‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏î‡∏∑‡πà‡∏°', price: 45, image: 'üßã', description: '‡∏ä‡∏≤‡πÑ‡∏ó‡∏¢‡πÄ‡∏Ç‡πâ‡∏°‡∏Ç‡πâ‡∏ô ‡∏´‡∏ß‡∏≤‡∏ô‡∏°‡∏±‡∏ô', prepTime: 5, available: true },
                        { id: 4, name: '‡∏™‡πâ‡∏°‡∏ï‡∏≥‡πÑ‡∏ó‡∏¢', category: '‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏à‡∏≤‡∏ô‡∏´‡∏•‡∏±‡∏Å', price: 80, image: 'ü•ó', description: '‡∏™‡πâ‡∏°‡∏ï‡∏≥‡∏£‡∏™‡πÅ‡∏ã‡πà‡∏ö ‡πÄ‡∏ú‡πá‡∏î‡∏ï‡∏≤‡∏°‡πÉ‡∏à', prepTime: 10, available: true },
                        { id: 5, name: '‡∏Å‡∏≤‡πÅ‡∏ü‡πÄ‡∏¢‡πá‡∏ô', category: '‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏î‡∏∑‡πà‡∏°', price: 50, image: '‚òï', description: '‡∏Å‡∏≤‡πÅ‡∏ü‡πÄ‡∏¢‡πá‡∏ô‡∏´‡∏≠‡∏°‡∏Å‡∏£‡∏∏‡πà‡∏ô', prepTime: 3, available: true }
                    ];
                }
            }

            loadCustomerData() {
                const savedOrders = localStorage.getItem('customerOrders');
                if (savedOrders) {
                    customerOrders = JSON.parse(savedOrders);
                }

                const savedCart = localStorage.getItem('customerCart');
                if (savedCart) {
                    cart = JSON.parse(savedCart);
                    updateCartDisplay();
                }

                const savedCustomerInfo = localStorage.getItem('customerInfo');
                if (savedCustomerInfo) {
                    const info = JSON.parse(savedCustomerInfo);
                    document.getElementById('customerName').value = info.name || '';
                    document.getElementById('customerPhone').value = info.phone || '';
                    document.getElementById('customerAddress').value = info.address || '';
                }
            }

            saveCustomerData() {
                localStorage.setItem('customerOrders', JSON.stringify(customerOrders));
                localStorage.setItem('customerCart', JSON.stringify(cart));
                
                const customerInfo = {
                    name: document.getElementById('customerName').value,
                    phone: document.getElementById('customerPhone').value,
                    address: document.getElementById('customerAddress').value
                };
                localStorage.setItem('customerInfo', JSON.stringify(customerInfo));
            }

            startRealTimeSync() {
                // Sync with POS system every 5 seconds
                setInterval(() => {
                    this.syncWithPOS();
                }, 5000);
            }

            syncWithPOS() {
                // Check for order status updates from POS
                const posData = localStorage.getItem('posSystemData');
                if (posData) {
                    const data = JSON.parse(posData);
                    
                    // Update customer orders with latest status from POS
                    customerOrders.forEach(customerOrder => {
                        const posOrder = data.orders.find(o => o.id === customerOrder.id);
                        if (posOrder && posOrder.status !== customerOrder.status) {
                            customerOrder.status = posOrder.status;
                            this.showOrderStatusUpdate(customerOrder);
                        }
                    });
                    
                    // Update available menus
                    menus = data.menus.filter(menu => menu.available);
                    if (currentTab === 'menu') {
                        renderMenus();
                    }
                    
                    this.saveCustomerData();
                }
            }

            showOrderStatusUpdate(order) {
                const statusText = this.getStatusText(order.status);
                showNotification(`‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå #${order.orderNumber}: ${statusText}`, 'info');
                
                if (currentTab === 'tracking') {
                    renderOrderTracking();
                }
            }

            addOrderToPOS(order) {
                // Add order to POS system
                const posData = localStorage.getItem('posSystemData');
                if (posData) {
                    const data = JSON.parse(posData);
                    data.orders.unshift(order);
                    localStorage.setItem('posSystemData', JSON.stringify(data));
                }
            }

            getStatusText(status) {
                const statusMap = {
                    'pending': '‡∏£‡∏≠‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£',
                    'preparing': '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°',
                    'ready': '‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏™‡πà‡∏á',
                    'delivered': '‡∏™‡πà‡∏á‡πÅ‡∏•‡πâ‡∏ß',
                    'cancelled': '‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å'
                };
                return statusMap[status] || status;
            }
        }

        // Initialize Customer Data Manager
        const customerDataManager = new CustomerDataManager();

        // Tab Management
        function showTab(tabName) {
            currentTab = tabName;
            
            // Hide all tabs
            document.querySelectorAll('.tab-content').forEach(tab => {
                tab.classList.add('hidden');
            });
            
            // Show selected tab
            document.getElementById(tabName + 'Tab').classList.remove('hidden');
            
            // Update tab buttons
            document.querySelectorAll('.tab-button').forEach(btn => {
                btn.classList.remove('active');
            });
            event.target.classList.add('active');
            
            // Render content
            if (tabName === 'menu') renderMenus();
            if (tabName === 'cart') renderCart();
            if (tabName === 'tracking') renderOrderTracking();
        }

        // Menu Management
        function renderMenus() {
            const menuGrid = document.getElementById('menuGrid');
            let filteredMenus = menus;
            
            if (currentMenuFilter !== 'all') {
                filteredMenus = menus.filter(menu => menu.category === currentMenuFilter);
            }
            
            if (filteredMenus.length === 0) {
                menuGrid.innerHTML = `
                    <div class="col-span-full text-center py-12">
                        <div class="text-6xl mb-4">üçΩÔ∏è</div>
                        <h3 class="text-2xl font-bold mb-2">‡πÑ‡∏°‡πà‡∏°‡∏µ‡πÄ‡∏°‡∏ô‡∏π‡πÉ‡∏ô‡∏´‡∏°‡∏ß‡∏î‡∏ô‡∏µ‡πâ</h3>
                        <p class="text-gray-600">‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡∏°‡∏ß‡∏î‡∏≠‡∏∑‡πà‡∏ô</p>
                    </div>
                `;
                return;
            }
            
            menuGrid.innerHTML = filteredMenus.map(menu => `
                <div class="menu-card bg-white rounded-xl shadow-lg overflow-hidden ${menu.isNew ? 'ring-2 ring-orange-400' : ''}">
                    <div class="relative">
                        <div class="w-full h-40 bg-gradient-to-br from-orange-100 to-orange-200 flex items-center justify-center overflow-hidden">
                            ${menu.imageUrl ? 
                                `<img src="${menu.imageUrl}" alt="${menu.name}" class="w-full h-full object-cover" onerror="this.style.display='none'; this.nextElementSibling.style.display='flex';">
                                 <div class="w-full h-full flex items-center justify-center text-5xl" style="display:none;">${menu.image}</div>` :
                                `<div class="text-5xl">${menu.image}</div>`
                            }
                        </div>
                        <div class="absolute top-3 right-3 bg-white rounded-full px-3 py-1 font-bold text-orange-600 shadow">
                            ${menu.price}‡∏ø
                        </div>
                        ${menu.isNew ? '<div class="absolute top-3 left-3 bg-red-500 text-white rounded-full px-2 py-1 text-xs font-bold pulse-animation">üÜï ‡πÉ‡∏´‡∏°‡πà!</div>' : ''}
                    </div>
                    <div class="p-4">
                        <h3 class="font-bold text-lg mb-2 text-gray-800">${menu.name}</h3>
                        <div class="text-xs bg-orange-100 text-orange-800 px-2 py-1 rounded-full inline-block mb-2">${menu.category}</div>
                        <p class="text-sm text-gray-600 mb-3">${menu.description}</p>
                        <div class="text-xs text-gray-500 mb-4">‚è±Ô∏è ${menu.prepTime} ‡∏ô‡∏≤‡∏ó‡∏µ</div>
                        <div class="flex items-center space-x-2">
                            <button onclick="decreaseQuantity(${menu.id})" class="bg-gray-200 text-gray-700 w-8 h-8 rounded-full hover:bg-gray-300 transition-all">-</button>
                            <span class="font-bold text-lg w-8 text-center" id="qty-${menu.id}">0</span>
                            <button onclick="increaseQuantity(${menu.id})" class="bg-orange-500 text-white w-8 h-8 rounded-full hover:bg-orange-600 transition-all">+</button>
                            <button onclick="addToCart(${menu.id})" class="flex-1 bg-green-500 text-white py-2 rounded-lg hover:bg-green-600 transition-all ml-3">
                                üõí ‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏•‡∏á‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤
                            </button>
                        </div>
                    </div>
                </div>
            `).join('');
            
            // Update quantity displays
            cart.forEach(item => {
                const qtyElement = document.getElementById(`qty-${item.id}`);
                if (qtyElement) {
                    qtyElement.textContent = item.quantity;
                }
            });
        }

        function filterMenu(category) {
            currentMenuFilter = category;
            
            // Update filter buttons
            document.querySelectorAll('.category-filter').forEach(btn => {
                btn.classList.remove('active', 'bg-orange-500', 'text-white');
                btn.classList.add('bg-gray-200', 'text-gray-700');
            });
            event.target.classList.add('active', 'bg-orange-500', 'text-white');
            event.target.classList.remove('bg-gray-200', 'text-gray-700');
            
            renderMenus();
        }

        // Cart Management
        function increaseQuantity(menuId) {
            const qtyElement = document.getElementById(`qty-${menuId}`);
            let currentQty = parseInt(qtyElement.textContent);
            currentQty++;
            qtyElement.textContent = currentQty;
        }

        function decreaseQuantity(menuId) {
            const qtyElement = document.getElementById(`qty-${menuId}`);
            let currentQty = parseInt(qtyElement.textContent);
            if (currentQty > 0) {
                currentQty--;
                qtyElement.textContent = currentQty;
            }
        }

        function addToCart(menuId) {
            const menu = menus.find(m => m.id === menuId);
            const qtyElement = document.getElementById(`qty-${menuId}`);
            const quantity = parseInt(qtyElement.textContent);
            
            if (quantity === 0) {
                showNotification('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏Å‡πà‡∏≠‡∏ô‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏•‡∏á‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤', 'error');
                return;
            }
            
            const existingItem = cart.find(item => item.id === menuId);
            if (existingItem) {
                existingItem.quantity += quantity;
                existingItem.totalPrice = existingItem.quantity * existingItem.price;
            } else {
                cart.push({
                    id: menu.id,
                    name: menu.name,
                    price: menu.price,
                    quantity: quantity,
                    totalPrice: menu.price * quantity,
                    image: menu.image
                });
            }
            
            // Reset quantity display
            qtyElement.textContent = '0';
            
            updateCartDisplay();
            customerDataManager.saveCustomerData();
            showNotification(`‡πÄ‡∏û‡∏¥‡πà‡∏° ${menu.name} ‡∏•‡∏á‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤‡πÅ‡∏•‡πâ‡∏ß!`, 'success');
        }

        function removeFromCart(menuId) {
            cart = cart.filter(item => item.id !== menuId);
            updateCartDisplay();
            renderCart();
            renderMenus(); // Update quantity displays
            customerDataManager.saveCustomerData();
            showNotification('‡∏•‡∏ö‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤‡πÅ‡∏•‡πâ‡∏ß', 'success');
        }

        function updateCartQuantity(menuId, newQuantity) {
            const item = cart.find(item => item.id === menuId);
            if (item) {
                if (newQuantity <= 0) {
                    removeFromCart(menuId);
                } else {
                    item.quantity = newQuantity;
                    item.totalPrice = item.price * newQuantity;
                    updateCartDisplay();
                    renderCart();
                    customerDataManager.saveCustomerData();
                }
            }
        }

        function updateCartDisplay() {
            const cartCount = cart.reduce((sum, item) => sum + item.quantity, 0);
            document.getElementById('cartCount').textContent = cartCount;
            document.getElementById('floatingCartCount').textContent = cartCount;
            
            // Show/hide floating cart button
            const floatingBtn = document.getElementById('floatingCartBtn');
            if (cartCount > 0) {
                floatingBtn.classList.remove('hidden');
            } else {
                floatingBtn.classList.add('hidden');
            }
        }

        function renderCart() {
            const cartItems = document.getElementById('cartItems');
            const cartSummary = document.getElementById('cartSummary');
            
            if (cart.length === 0) {
                cartItems.innerHTML = `
                    <div class="text-center py-12">
                        <div class="text-6xl mb-4">üõí</div>
                        <h3 class="text-2xl font-bold mb-2">‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤‡∏ß‡πà‡∏≤‡∏á‡πÄ‡∏õ‡∏•‡πà‡∏≤</h3>
                        <p class="text-gray-600 mb-4">‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏•‡∏á‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏™‡∏±‡πà‡∏á</p>
                        <button onclick="showTab('menu')" class="bg-orange-500 text-white px-6 py-3 rounded-lg hover:bg-orange-600 transition-all">
                            üçΩÔ∏è ‡∏î‡∏π‡πÄ‡∏°‡∏ô‡∏π‡∏≠‡∏≤‡∏´‡∏≤‡∏£
                        </button>
                    </div>
                `;
                cartSummary.innerHTML = '';
                return;
            }
            
            cartItems.innerHTML = cart.map(item => `
                <div class="cart-item flex items-center justify-between p-4 bg-gray-50 rounded-lg">
                    <div class="flex items-center space-x-4">
                        <div class="text-3xl">${item.image}</div>
                        <div>
                            <h4 class="font-bold">${item.name}</h4>
                            <p class="text-gray-600">${item.price}‡∏ø x ${item.quantity}</p>
                        </div>
                    </div>
                    <div class="flex items-center space-x-3">
                        <div class="flex items-center space-x-2">
                            <button onclick="updateCartQuantity(${item.id}, ${item.quantity - 1})" class="bg-gray-200 text-gray-700 w-8 h-8 rounded-full hover:bg-gray-300 transition-all">-</button>
                            <span class="font-bold text-lg w-8 text-center">${item.quantity}</span>
                            <button onclick="updateCartQuantity(${item.id}, ${item.quantity + 1})" class="bg-orange-500 text-white w-8 h-8 rounded-full hover:bg-orange-600 transition-all">+</button>
                        </div>
                        <div class="font-bold text-lg text-orange-600 w-20 text-right">${item.totalPrice}‡∏ø</div>
                        <button onclick="removeFromCart(${item.id})" class="bg-red-500 text-white px-3 py-2 rounded-lg hover:bg-red-600 transition-all">
                            üóëÔ∏è
                        </button>
                    </div>
                </div>
            `).join('');
            
            const subtotal = cart.reduce((sum, item) => sum + item.totalPrice, 0);
            const deliveryFee = 30;
            const total = subtotal + deliveryFee;
            
            cartSummary.innerHTML = `
                <div class="space-y-3">
                    <div class="flex justify-between">
                        <span>‡∏£‡∏≤‡∏Ñ‡∏≤‡∏£‡∏ß‡∏°:</span>
                        <span>${subtotal}‡∏ø</span>
                    </div>
                    <div class="flex justify-between">
                        <span>‡∏Ñ‡πà‡∏≤‡∏à‡∏±‡∏î‡∏™‡πà‡∏á:</span>
                        <span>${deliveryFee}‡∏ø</span>
                    </div>
                    <div class="flex justify-between font-bold text-lg border-t pt-3">
                        <span>‡∏£‡∏ß‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î:</span>
                        <span class="text-orange-600">${total}‡∏ø</span>
                    </div>
                    <button onclick="proceedToPayment()" class="w-full bg-green-500 text-white py-4 rounded-lg hover:bg-green-600 transition-all font-bold text-lg mt-6">
                        üí≥ ‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡∏™‡∏±‡πà‡∏á‡∏≠‡∏≤‡∏´‡∏≤‡∏£
                    </button>
                </div>
            `;
        }

        // Payment Process
        function proceedToPayment() {
            // Validate customer info
            const name = document.getElementById('customerName').value.trim();
            const phone = document.getElementById('customerPhone').value.trim();
            const address = document.getElementById('customerAddress').value.trim();
            
            if (!name || !phone || !address) {
                showNotification('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏•‡∏π‡∏Å‡∏Ñ‡πâ‡∏≤‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏ö‡∏ñ‡πâ‡∏ß‡∏ô', 'error');
                showTab('menu');
                return;
            }
            
            if (cart.length === 0) {
                showNotification('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏Å‡πà‡∏≠‡∏ô‡∏™‡∏±‡πà‡∏á', 'error');
                return;
            }
            
            showPaymentModal();
        }

        function showPaymentModal() {
            document.getElementById('paymentModal').classList.remove('hidden');
            renderPaymentSummary();
            loadPaymentInfo();
            
            // Show/hide sections based on payment method
            document.querySelectorAll('input[name="paymentMethod"]').forEach(radio => {
                radio.addEventListener('change', function() {
                    const bankTransferDetails = document.getElementById('bankTransferDetails');
                    const slipUploadSection = document.getElementById('slipUploadSection');
                    
                    if (this.value === 'transfer') {
                        bankTransferDetails.classList.remove('hidden');
                        slipUploadSection.classList.remove('hidden');
                    } else {
                        bankTransferDetails.classList.add('hidden');
                        slipUploadSection.classList.add('hidden');
                    }
                });
            });
        }

        function closePaymentModal() {
            document.getElementById('paymentModal').classList.add('hidden');
            uploadedSlip = null;
            
            // Reset slip preview
            const previewContainer = document.getElementById('slipPreviewContainer');
            previewContainer.innerHTML = 'üìÑ';
            previewContainer.className = 'w-32 h-32 mx-auto bg-gray-100 rounded-lg flex items-center justify-center text-4xl';
        }

        function renderPaymentSummary() {
            const subtotal = cart.reduce((sum, item) => sum + item.totalPrice, 0);
            const deliveryFee = 30;
            const total = subtotal + deliveryFee;
            
            document.getElementById('paymentOrderSummary').innerHTML = `
                <div class="space-y-2 text-sm">
                    ${cart.map(item => `
                        <div class="flex justify-between">
                            <span>${item.name} x${item.quantity}</span>
                            <span>${item.totalPrice}‡∏ø</span>
                        </div>
                    `).join('')}
                    <div class="border-t pt-2 mt-2">
                        <div class="flex justify-between">
                            <span>‡∏£‡∏≤‡∏Ñ‡∏≤‡∏£‡∏ß‡∏°:</span>
                            <span>${subtotal}‡∏ø</span>
                        </div>
                        <div class="flex justify-between">
                            <span>‡∏Ñ‡πà‡∏≤‡∏à‡∏±‡∏î‡∏™‡πà‡∏á:</span>
                            <span>${deliveryFee}‡∏ø</span>
                        </div>
                        <div class="flex justify-between font-bold text-lg">
                            <span>‡∏£‡∏ß‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î:</span>
                            <span class="text-orange-600">${total}‡∏ø</span>
                        </div>
                    </div>
                </div>
            `;
        }

        function loadPaymentInfo() {
            const paymentSettings = JSON.parse(localStorage.getItem('paymentSettings') || '{}');
            
            document.getElementById('bankInfo').innerHTML = `
                <div><strong>‡∏ò‡∏ô‡∏≤‡∏Ñ‡∏≤‡∏£:</strong> ${paymentSettings.bankName || '‡∏ò‡∏ô‡∏≤‡∏Ñ‡∏≤‡∏£‡∏Å‡∏™‡∏¥‡∏Å‡∏£‡πÑ‡∏ó‡∏¢'}</div>
                <div><strong>‡πÄ‡∏•‡∏Ç‡∏ó‡∏µ‡πà‡∏ö‡∏±‡∏ç‡∏ä‡∏µ:</strong> ${paymentSettings.accountNumber || '123-4-56789-0'}</div>
                <div><strong>‡∏ä‡∏∑‡πà‡∏≠‡∏ö‡∏±‡∏ç‡∏ä‡∏µ:</strong> ${paymentSettings.accountName || '‡∏£‡πâ‡∏≤‡∏ô‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏î‡∏µ‡∏•‡∏¥‡πÄ‡∏ä‡∏µ‡∏¢‡∏™'}</div>
                <div class="font-bold text-blue-600 text-lg mt-2">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏á‡∏¥‡∏ô: ${cart.reduce((sum, item) => sum + item.totalPrice, 0) + 30}‡∏ø</div>
            `;
            
            if (paymentSettings.qrCodeUrl) {
                document.getElementById('qrCodeSection').innerHTML = `
                    <div class="inline-block p-3 bg-white rounded-lg shadow-md">
                        <img src="${paymentSettings.qrCodeUrl}" alt="QR Code ‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô" class="w-40 h-40 mx-auto">
                    </div>
                    <p class="text-sm text-blue-600 mt-2">‡∏™‡πÅ‡∏Å‡∏ô QR Code ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÇ‡∏≠‡∏ô‡πÄ‡∏á‡∏¥‡∏ô</p>
                `;
            }
        }

        function handleSlipUpload(event) {
            const file = event.target.files[0];
            if (file) {
                // Validate file type
                if (!file.type.startsWith('image/')) {
                    showNotification('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÑ‡∏ü‡∏•‡πå‡∏£‡∏π‡∏õ‡∏†‡∏≤‡∏û‡πÄ‡∏ó‡πà‡∏≤‡∏ô‡∏±‡πâ‡∏ô', 'error');
                    return;
                }

                // Validate file size (max 5MB)
                if (file.size > 5 * 1024 * 1024) {
                    showNotification('‡∏Ç‡∏ô‡∏≤‡∏î‡πÑ‡∏ü‡∏•‡πå‡∏ï‡πâ‡∏≠‡∏á‡πÑ‡∏°‡πà‡πÄ‡∏Å‡∏¥‡∏ô 5MB', 'error');
                    return;
                }

                const reader = new FileReader();
                reader.onload = function(e) {
                    uploadedSlip = e.target.result;
                    
                    // Update preview
                    const previewContainer = document.getElementById('slipPreviewContainer');
                    previewContainer.innerHTML = `<img src="${uploadedSlip}" alt="‡∏™‡∏•‡∏¥‡∏õ‡∏Å‡∏≤‡∏£‡πÇ‡∏≠‡∏ô‡πÄ‡∏á‡∏¥‡∏ô" class="slip-preview rounded-lg">`;
                    previewContainer.className = 'w-32 h-32 mx-auto bg-gray-100 rounded-lg overflow-hidden flex items-center justify-center';
                    
                    showNotification('‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡∏™‡∏•‡∏¥‡∏õ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!', 'success');
                };
                reader.readAsDataURL(file);
            }
        }

        function confirmOrder() {
            const paymentMethod = document.querySelector('input[name="paymentMethod"]:checked').value;
            
            // Validate payment method requirements
            if (paymentMethod === 'transfer' && !uploadedSlip) {
                showNotification('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡∏™‡∏•‡∏¥‡∏õ‡∏Å‡∏≤‡∏£‡πÇ‡∏≠‡∏ô‡πÄ‡∏á‡∏¥‡∏ô', 'error');
                return;
            }
            
            // Create order
            const subtotal = cart.reduce((sum, item) => sum + item.totalPrice, 0);
            const deliveryFee = 30;
            const total = subtotal + deliveryFee;
            
            const order = {
                id: Date.now().toString(),
                orderNumber: Math.floor(100000 + Math.random() * 900000).toString(),
                queueNumber: getNextQueueNumber(),
                customerName: document.getElementById('customerName').value,
                customerPhone: document.getElementById('customerPhone').value,
                customerAddress: document.getElementById('customerAddress').value,
                items: [...cart],
                subtotal: subtotal,
                deliveryFee: deliveryFee,
                total: total,
                paymentMethod: paymentMethod,
                paymentSlip: uploadedSlip,
                status: 'pending',
                createdAt: new Date().toISOString(),
                estimatedTime: Math.max(...cart.map(item => {
                    const menu = menus.find(m => m.id === item.id);
                    return menu ? menu.prepTime : 15;
                })) + 10
            };
            
            // Add to customer orders
            customerOrders.unshift(order);
            
            // Add to POS system
            customerDataManager.addOrderToPOS(order);
            
            // Clear cart
            cart = [];
            updateCartDisplay();
            
            // Save data
            customerDataManager.saveCustomerData();
            
            // Close modal and show success
            closePaymentModal();
            showNotification(`‡∏™‡∏±‡πà‡∏á‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à! ‡∏´‡∏°‡∏≤‡∏¢‡πÄ‡∏•‡∏Ç‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå: ${order.orderNumber}`, 'success');
            
            // Switch to tracking tab
            showTab('tracking');
        }

        function getNextQueueNumber() {
            const activeOrders = customerOrders.filter(o => 
                o.status !== 'delivered' && o.status !== 'cancelled'
            );
            return activeOrders.length > 0 ? Math.max(...activeOrders.map(o => o.queueNumber)) + 1 : 1;
        }

        // Order Tracking
        function renderOrderTracking() {
            const activeOrdersContainer = document.getElementById('activeOrders');
            const activeOrders = customerOrders.filter(o => 
                o.status !== 'delivered' && o.status !== 'cancelled'
            );
            
            if (activeOrders.length === 0) {
                activeOrdersContainer.innerHTML = `
                    <div class="text-center py-12">
                        <div class="text-6xl mb-4">üì¶</div>
                        <h3 class="text-2xl font-bold mb-2">‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå‡∏ó‡∏µ‡πà‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£</h3>
                        <p class="text-gray-600 mb-4">‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏™‡∏±‡πà‡∏á‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡πÅ‡∏•‡πâ‡∏ß ‡∏à‡∏∞‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏ï‡∏¥‡∏î‡∏ï‡∏≤‡∏°‡πÑ‡∏î‡πâ‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà</p>
                        <button onclick="showTab('menu')" class="bg-orange-500 text-white px-6 py-3 rounded-lg hover:bg-orange-600 transition-all">
                            üçΩÔ∏è ‡∏™‡∏±‡πà‡∏á‡∏≠‡∏≤‡∏´‡∏≤‡∏£
                        </button>
                    </div>
                `;
                return;
            }
            
            activeOrdersContainer.innerHTML = activeOrders.map(order => `
                <div class="bg-white border rounded-xl p-6 shadow-lg">
                    <div class="flex justify-between items-start mb-6">
                        <div>
                            <h3 class="text-xl font-bold text-gray-800">‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå #${order.orderNumber}</h3>
                            <p class="text-gray-600">‡∏Ñ‡∏¥‡∏ß‡∏ó‡∏µ‡πà ${order.queueNumber} ‚Ä¢ ${new Date(order.createdAt).toLocaleString('th-TH')}</p>
                            <p class="text-sm text-gray-500">‡πÄ‡∏ß‡∏•‡∏≤‡πÇ‡∏î‡∏¢‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì: ${order.estimatedTime} ‡∏ô‡∏≤‡∏ó‡∏µ</p>
                        </div>
                        <div class="status-badge status-${order.status}">${customerDataManager.getStatusText(order.status)}</div>
                    </div>
                    
                    <!-- Order Items -->
                    <div class="mb-6">
                        <h4 class="font-bold mb-3">‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏≠‡∏≤‡∏´‡∏≤‡∏£:</h4>
                        <div class="space-y-2">
                            ${order.items.map(item => `
                                <div class="flex justify-between items-center text-sm bg-gray-50 p-3 rounded">
                                    <span class="flex items-center">
                                        <span class="text-lg mr-2">${item.image}</span>
                                        ${item.name} x${item.quantity}
                                    </span>
                                    <span class="font-bold">${item.totalPrice}‡∏ø</span>
                                </div>
                            `).join('')}
                        </div>
                        <div class="border-t pt-3 mt-3">
                            <div class="flex justify-between font-bold text-lg">
                                <span>‡∏£‡∏ß‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î:</span>
                                <span class="text-orange-600">${order.total}‡∏ø</span>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Order Progress -->
                    <div class="order-tracking">
                        <h4 class="font-bold mb-4">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≤‡∏£‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£:</h4>
                        <div class="space-y-4">
                            ${getOrderProgress(order.status)}
                        </div>
                    </div>
                    
                    <!-- Payment Info -->
                    ${order.paymentMethod === 'transfer' && order.paymentSlip ? `
                        <div class="mt-6 p-4 bg-green-50 rounded-lg border border-green-200">
                            <h4 class="font-bold mb-2 text-green-800">üí≥ ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô</h4>
                            <p class="text-sm text-green-700 mb-2">‡πÇ‡∏≠‡∏ô‡πÄ‡∏á‡∏¥‡∏ô‡∏ú‡πà‡∏≤‡∏ô‡∏ò‡∏ô‡∏≤‡∏Ñ‡∏≤‡∏£ - ‡∏£‡∏≠‡∏ï‡∏£‡∏ß‡∏à‡∏™‡∏≠‡∏ö</p>
                            <button onclick="showSlipModal('${order.id}')" class="text-green-600 hover:text-green-800 text-sm underline">
                                üëÅÔ∏è ‡∏î‡∏π‡∏™‡∏•‡∏¥‡∏õ‡∏Å‡∏≤‡∏£‡πÇ‡∏≠‡∏ô‡πÄ‡∏á‡∏¥‡∏ô
                            </button>
                        </div>
                    ` : order.paymentMethod === 'cod' ? `
                        <div class="mt-6 p-4 bg-blue-50 rounded-lg border border-blue-200">
                            <h4 class="font-bold mb-2 text-blue-800">üíµ ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏á‡∏¥‡∏ô</h4>
                            <p class="text-sm text-blue-700">‡πÄ‡∏Å‡πá‡∏ö‡πÄ‡∏á‡∏¥‡∏ô‡∏õ‡∏•‡∏≤‡∏¢‡∏ó‡∏≤‡∏á - ‡∏ä‡∏≥‡∏£‡∏∞‡πÄ‡∏°‡∏∑‡πà‡∏≠‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏≠‡∏≤‡∏´‡∏≤‡∏£</p>
                        </div>
                    ` : ''}
                    
                    <!-- Contact Info -->
                    <div class="mt-6 p-4 bg-gray-50 rounded-lg">
                        <h4 class="font-bold mb-2">üìç ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡∏à‡∏±‡∏î‡∏™‡πà‡∏á</h4>
                        <p class="text-sm"><strong>‡∏ä‡∏∑‡πà‡∏≠:</strong> ${order.customerName}</p>
                        <p class="text-sm"><strong>‡πÄ‡∏ö‡∏≠‡∏£‡πå:</strong> ${order.customerPhone}</p>
                        <p class="text-sm"><strong>‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà:</strong> ${order.customerAddress}</p>
                    </div>
                </div>
            `).join('');
        }

        function getOrderProgress(currentStatus) {
            const steps = [
                { status: 'pending', text: '‡∏£‡∏±‡∏ö‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå‡πÅ‡∏•‡πâ‡∏ß', icon: 'üìã' },
                { status: 'preparing', text: '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡∏≠‡∏≤‡∏´‡∏≤‡∏£', icon: 'üë®‚Äçüç≥' },
                { status: 'ready', text: '‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏û‡∏£‡πâ‡∏≠‡∏°', icon: '‚úÖ' },
                { status: 'delivered', text: '‡∏à‡∏±‡∏î‡∏™‡πà‡∏á‡πÅ‡∏•‡πâ‡∏ß', icon: 'üöö' }
            ];
            
            const statusOrder = ['pending', 'preparing', 'ready', 'delivered'];
            const currentIndex = statusOrder.indexOf(currentStatus);
            
            return steps.map((step, index) => {
                const isCompleted = index <= currentIndex;
                const isCurrent = index === currentIndex;
                
                return `
                    <div class="tracking-step flex items-center ${isCompleted ? 'completed' : ''}">
                        <div class="w-8 h-8 rounded-full flex items-center justify-center text-sm font-bold mr-4 ${
                            isCompleted ? 'bg-green-500 text-white' : 'bg-gray-200 text-gray-500'
                        } ${isCurrent ? 'pulse-animation' : ''}">
                            ${step.icon}
                        </div>
                        <div class="flex-1">
                            <div class="font-medium ${isCompleted ? 'text-green-600' : 'text-gray-500'}">${step.text}</div>
                            ${isCurrent ? '<div class="text-sm text-blue-600">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£...</div>' : ''}
                        </div>
                        ${isCompleted ? '<div class="text-green-500 font-bold">‚úì</div>' : ''}
                    </div>
                `;
            }).join('');
        }

        // Order History
        function showOrderHistory() {
            document.getElementById('orderHistoryModal').classList.remove('hidden');
            renderOrderHistory();
        }

        function closeOrderHistoryModal() {
            document.getElementById('orderHistoryModal').classList.add('hidden');
        }

        function renderOrderHistory() {
            const orderHistoryContent = document.getElementById('orderHistoryContent');
            
            if (customerOrders.length === 0) {
                orderHistoryContent.innerHTML = `
                    <div class="text-center py-12">
                        <div class="text-6xl mb-4">üìã</div>
                        <h3 class="text-2xl font-bold mb-2">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏Å‡∏≤‡∏£‡∏™‡∏±‡πà‡∏á‡∏≠‡∏≤‡∏´‡∏≤‡∏£</h3>
                        <p class="text-gray-600">‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏™‡∏±‡πà‡∏á‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡πÅ‡∏•‡πâ‡∏ß ‡∏õ‡∏£‡∏∞‡∏ß‡∏±‡∏ï‡∏¥‡∏à‡∏∞‡πÅ‡∏™‡∏î‡∏á‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà</p>
                    </div>
                `;
                return;
            }
            
            orderHistoryContent.innerHTML = customerOrders.map(order => `
                <div class="bg-white border rounded-xl p-6">
                    <div class="flex justify-between items-start mb-4">
                        <div>
                            <h3 class="text-lg font-bold text-gray-800">‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå #${order.orderNumber}</h3>
                            <p class="text-gray-600">${new Date(order.createdAt).toLocaleString('th-TH')}</p>
                        </div>
                        <div class="status-badge status-${order.status}">${customerDataManager.getStatusText(order.status)}</div>
                    </div>
                    
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            <h4 class="font-bold mb-2">‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏≠‡∏≤‡∏´‡∏≤‡∏£:</h4>
                            <div class="space-y-1 text-sm">
                                ${order.items.map(item => `
                                    <div class="flex justify-between">
                                        <span>${item.image} ${item.name} x${item.quantity}</span>
                                        <span>${item.totalPrice}‡∏ø</span>
                                    </div>
                                `).join('')}
                                <div class="border-t pt-2 font-bold">
                                    <div class="flex justify-between">
                                        <span>‡∏£‡∏ß‡∏°‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î:</span>
                                        <span class="text-orange-600">${order.total}‡∏ø</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                        
                        <div>
                            <h4 class="font-bold mb-2">‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≤‡∏£‡∏™‡∏±‡πà‡∏á:</h4>
                            <div class="text-sm space-y-1">
                                <div><strong>‡∏ä‡∏∑‡πà‡∏≠:</strong> ${order.customerName}</div>
                                <div><strong>‡πÄ‡∏ö‡∏≠‡∏£‡πå:</strong> ${order.customerPhone}</div>
                                <div><strong>‡∏Å‡∏≤‡∏£‡∏ä‡∏≥‡∏£‡∏∞:</strong> ${order.paymentMethod === 'transfer' ? '‡πÇ‡∏≠‡∏ô‡πÄ‡∏á‡∏¥‡∏ô' : '‡πÄ‡∏Å‡πá‡∏ö‡πÄ‡∏á‡∏¥‡∏ô‡∏õ‡∏•‡∏≤‡∏¢‡∏ó‡∏≤‡∏á'}</div>
                                ${order.paymentSlip ? `
                                    <button onclick="showSlipModal('${order.id}')" class="text-blue-600 hover:text-blue-800 underline">
                                        üëÅÔ∏è ‡∏î‡∏π‡∏™‡∏•‡∏¥‡∏õ‡∏Å‡∏≤‡∏£‡πÇ‡∏≠‡∏ô‡πÄ‡∏á‡∏¥‡∏ô
                                    </button>
                                ` : ''}
                            </div>
                        </div>
                    </div>
                </div>
            `).join('');
        }

        function showSlipModal(orderId) {
            const order = customerOrders.find(o => o.id === orderId);
            if (order && order.paymentSlip) {
                const modal = document.createElement('div');
                modal.className = 'fixed inset-0 bg-black bg-opacity-75 flex items-center justify-center z-50';
                modal.innerHTML = `
                    <div class="bg-white rounded-xl p-6 max-w-md mx-4">
                        <div class="flex justify-between items-center mb-4">
                            <h3 class="text-lg font-bold">‡∏™‡∏•‡∏¥‡∏õ‡∏Å‡∏≤‡∏£‡πÇ‡∏≠‡∏ô‡πÄ‡∏á‡∏¥‡∏ô</h3>
                            <button onclick="this.closest('.fixed').remove()" class="text-gray-500 hover:text-gray-700 text-2xl">‚úï</button>
                        </div>
                        <div class="text-center">
                            <img src="${order.paymentSlip}" alt="‡∏™‡∏•‡∏¥‡∏õ‡∏Å‡∏≤‡∏£‡πÇ‡∏≠‡∏ô‡πÄ‡∏á‡∏¥‡∏ô" class="max-w-full max-h-96 mx-auto rounded-lg shadow-lg">
                            <p class="text-sm text-gray-600 mt-3">‡∏≠‡∏≠‡πÄ‡∏î‡∏≠‡∏£‡πå #${order.orderNumber}</p>
                            <p class="text-sm text-gray-600">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏á‡∏¥‡∏ô: ${order.total}‡∏ø</p>
                        </div>
                    </div>
                `;
                document.body.appendChild(modal);
            }
        }

        // Utility Functions
        function showNotification(message, type = 'info') {
            const notification = document.createElement('div');
            notification.className = `notification ${type}`;
            notification.textContent = message;
            
            document.body.appendChild(notification);
            
            setTimeout(() => {
                notification.remove();
            }, 4000);
        }

        // Initialize
        function init() {
            renderMenus();
            updateCartDisplay();
            
            // Load customer info if exists
            customerDataManager.loadCustomerData();
        }

        // Start the application
        init();
    </script>
<script>(function(){function c(){var b=a.contentDocument||a.contentWindow.document;if(b){var d=b.createElement('script');d.innerHTML="window.__CF$cv$params={r:'97c7855596aa3231',t:'MTc1NzQyOTY2Ni4wMDAwMDA='};var a=document.createElement('script');a.nonce='';a.src='/cdn-cgi/challenge-platform/scripts/jsd/main.js';document.getElementsByTagName('head')[0].appendChild(a);";b.getElementsByTagName('head')[0].appendChild(d)}}if(document.body){var a=document.createElement('iframe');a.height=1;a.width=1;a.style.position='absolute';a.style.top=0;a.style.left=0;a.style.border='none';a.style.visibility='hidden';document.body.appendChild(a);if('loading'!==document.readyState)c();else if(window.addEventListener)document.addEventListener('DOMContentLoaded',c);else{var e=document.onreadystatechange||function(){};document.onreadystatechange=function(b){e(b);'loading'!==document.readyState&&(document.onreadystatechange=e,c())}}}})();</script></body>
</html>
